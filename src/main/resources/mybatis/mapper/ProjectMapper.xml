<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huag.collaboration.mapper.ProjectMapper">

    <!--嵌套结果集的方式，使用collection标签定义关联的集合类型的属性封装规则  -->
    <resultMap type="com.huag.collaboration.entities.Project" id="myProject">
        <id column="id" property="id"/>
        <!--
            collection定义关联集合类型的属性的封装规则
            ofType:指定集合里面元素的类型
        -->
        <collection property="projectSubitems" ofType="com.huag.collaboration.entities.ProjectSubitem">
            <!-- 定义这个集合中元素的封装规则 -->
            <id column="id" property="id"/>
            <!--<result column="last_name" property="lastName"/>-->
        </collection>
    </resultMap>

    <resultMap type="com.huag.collaboration.entities.Project" id="myProject1">
        <id column="id" property="id"/>
        <result column="projectName"  property="projectName"/>
        <result column="designPhase"  property="designPhase"/>
        <result column="startTime" property="startTime"/>
        <result column="stopTime" property="stopTime"/>
        <result column="leftTime" property="leftTime"/>
        <result column="currentProcess" property="currentProcess"/>
        <result column="emergencyLevel" property="emergencyLevel"/>
        <result column="deltag" property="deltag"/>
    </resultMap>


    <select id="findAll" resultType="com.huag.collaboration.entities.Project">
        SELECT * FROM project where deltag <![CDATA[ <> ]]> '1' or deltag is null
    </select>

    <select id="findById" resultType="com.huag.collaboration.entities.Project">
        SELECT * FROM project WHERE id=#{id} and (deltag <![CDATA[ <> ]]> '1' or deltag is null)
    </select>

    <insert id="deleteById">
        update project set deltag = 1 where id = #{id}
    </insert>

    <insert id="insert">
        INSERT INTO project(projectName, designPhase, startTime, stopTime, leftTime, currentProcess, emergencyLevel, deltag)
         VALUES (#{projectName}, #{designPhase}, #{startTime}, #{stopTime}, #{leftTime}, #{currentProcess}, #{emergencyLevel}, #{deltag})
    </insert>

    <insert id="update">
        update project set projectName = #{projectName}, designPhase = #{designPhase},
        startTime = #{startTime}, stopTime = #{stopTime}, leftTime = #{leftTime}, currentProcess = #{currentProcess},
         emergencyLevel = #{emergencyLevel}, deltag = #{deltag} where id = #{id}
    </insert>

</mapper>